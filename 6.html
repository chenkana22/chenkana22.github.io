<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>記憶卡牌遊戲</title>

<style>
body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    background: #eee;
    overflow: hidden;
}

h1 { margin-bottom: 20px; }

.game-container {
    position: relative;
    width: 1100px;
}

.board {
    display: grid;
    gap: 10px;
    margin-bottom: 20px;
}

/* 卡牌 */
.card {
    width: 100px;
    height: 100px;
    perspective: 1000px;
}

.card-inner {
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    cursor: pointer;
}

.card-back, .card-front {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 10px;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 28px;
}

.card-back {
    background-image: url("imagesback.png");
    background-size: cover;
}

.card-front {
    background: #ff9800;
    color: white;
    transform: rotateY(180deg);
}

.flipped .card-inner,
.matched .card-inner {
    transform: rotateY(180deg);
}

/* 堆疊區 */
.stack-area {
    width: 100px;
    height: 100px;
    background: #bbb;
    border-radius: 10px;
    position: absolute;
    right: 0;
    top: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}

/* 控制區 */
.restart-btn {
    position: absolute;
    bottom: -60px;
    left: 0;
    padding: 10px 20px;
    background: #d32f2f;
    color: white;
    border: none;
    border-radius: 6px;
}

.score-board {
    position: absolute;
    bottom: -60px;
    right: 0;
    padding: 10px 20px;
    background: #1976d2;
    color: white;
    border-radius: 6px;
}

/* 關卡選擇 */
.level-select {
    position: absolute;
    top: 130px;
    right: 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.level-select button {
    padding: 6px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background: #6fb9dd;
    color: white;
}

/* 勝利 */
#winText {
    position: fixed;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 60px;
    color: #6fb9dd;
    display: none;
}

/* 星星 */
.star {
    position: fixed;
    background: #8fd3ff;
    border-radius: 50%;
    animation: fall linear infinite;
}

@keyframes fall {
    from { transform: translateY(-10px); }
    to { transform: translateY(120vh); }
}
</style>
</head>

<body>

<h1>記憶卡牌遊戲</h1>
<div id="winText">挑戰成功！</div>

<div class="game-container">
    <div id="board" class="board"></div>

    <div class="stack-area">
        配對堆疊
        <div class="level-select">
            <button onclick="setLevel('easy')">簡單 2×5</button>
            <button onclick="setLevel('medium')">中等 5×6</button>
            <button onclick="setLevel('hard')">困難 5×8</button>
        </div>
    </div>

    <button id="restartBtn" class="restart-btn">重新開始</button>
    <div id="scoreBoard" class="score-board">得分：0</div>
</div>

<script>
const board = document.getElementById("board");
const scoreBoard = document.getElementById("scoreBoard");
const winText = document.getElementById("winText");

let firstCard, secondCard, lockBoard, score, starInterval;

/* 關卡設定 */
const levels = {
    easy:   { rows: 2, cols: 5, pairs: 5 },
    medium: { rows: 5, cols: 6, pairs: 15 },
    hard:   { rows: 5, cols: 8, pairs: 20 }
};

let currentLevel = levels.medium;

function setLevel(level) {
    currentLevel = levels[level];
    createBoard();
}

function generateCards() {
    let arr = [];
    for (let i = 1; i <= currentLevel.pairs; i++) {
        arr.push(i, i);
    }
    return arr.sort(() => Math.random() - 0.5);
}

function createBoard() {
    board.innerHTML = "";
    winText.style.display = "none";
    score = 0;
    scoreBoard.textContent = "得分：" + score;
    firstCard = secondCard = null;
    lockBoard = false;

    board.style.gridTemplateColumns = `repeat(${currentLevel.cols}, 100px)`;
    board.style.gridTemplateRows = `repeat(${currentLevel.rows}, 100px)`;

    generateCards().forEach(value => {
        const card = document.createElement("div");
        card.className = "card";
        card.dataset.value = value;

        card.innerHTML = `
            <div class="card-inner">
                <div class="card-back"></div>
                <div class="card-front">${value}</div>
            </div>
        `;

        card.addEventListener("click", flipCard);
        board.appendChild(card);
    });
}

function flipCard() {
    if (lockBoard || this === firstCard || this.classList.contains("matched")) return;
    this.classList.add("flipped");

    if (!firstCard) {
        firstCard = this;
        return;
    }
    secondCard = this;
    lockBoard = true;
    setTimeout(checkMatch, 600);
}

function checkMatch() {
    if (firstCard.dataset.value === secondCard.dataset.value) {
        firstCard.classList.add("matched");
        secondCard.classList.add("matched");
        score++;
        scoreBoard.textContent = "得分：" + score;

        if (score === currentLevel.pairs) winText.style.display = "block";
    } else {
        firstCard.classList.remove("flipped");
        secondCard.classList.remove("flipped");
    }
    firstCard = secondCard = null;
    lockBoard = false;
}

document.getElementById("restartBtn").onclick = createBoard;
createBoard();
</script>

</body>
</html>
