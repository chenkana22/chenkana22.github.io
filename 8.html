<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>記憶卡牌遊戲</title>

<style>
body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    flex-direction: column;
    align-items: center;
    background: #eee;
    overflow-x: hidden;
}

h1 { margin: 20px 0; }

.game-container {
    position: relative;
    width: 1100px;
    max-width: 100%;
}

/* ====== 卡牌棋盤 ====== */
.board {
    display: grid;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
}

/* ====== 卡牌 ====== */
.card {
    width: 100px;
    height: 100px;
    perspective: 1000px;
}

.card-inner {
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    cursor: pointer;
}

.card-back,
.card-front {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 12px;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* ✅ 解方一：圖片完整顯示 */
.card-back {
    background-image: url("imagesback.png");
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    background-color: white;
}

.card-front {
    background: #ff9800;
    color: white;
    font-size: 28px;
    transform: rotateY(180deg);
}

.flipped .card-inner,
.matched .card-inner {
    transform: rotateY(180deg);
}

/* ====== 控制區 ====== */
.controls {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
    gap: 10px;
    flex-wrap: wrap;
}

.restart-btn {
    padding: 10px 20px;
    background: #d32f2f;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}

.score-board {
    padding: 10px 20px;
    background: #1976d2;
    color: white;
    border-radius: 6px;
}

/* ====== 關卡選擇 ====== */
.levels {
    margin-top: 15px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.levels button {
    padding: 8px 14px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: #81d4fa;
}

.levels button.active {
    background: #0288d1;
    color: white;
}

/* ====== 勝利文字 ====== */
#winText {
    position: fixed;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 60px;
    font-weight: bold;
    color: #6fb9dd;
    text-shadow:
        0 0 8px white,
        0 0 20px #6fb9dd;
    display: none;
    z-index: 999;
}

/* ====== 手機自適應 ====== */
@media (max-width: 600px) {
    .card {
        width: 70px;
        height: 70px;
    }

    .card-front {
        font-size: 20px;
    }

    #winText {
        font-size: 36px;
    }
}
</style>
</head>

<body>

<h1>記憶卡牌遊戲</h1>
<div id="winText">挑戰成功！</div>

<div class="game-container">

    <div id="board" class="board"></div>

    <div class="controls">
        <button class="restart-btn" id="restartBtn">重新開始</button>
        <div class="score-board" id="scoreBoard">得分：0</div>
    </div>

    <div class="levels">
        <button onclick="setLevel(2,5,this)">簡單 2×5</button>
        <button class="active" onclick="setLevel(5,6,this)">中等 5×6</button>
        <button onclick="setLevel(5,8,this)">困難 5×8</button>
    </div>

</div>

<script>
const board = document.getElementById("board");
const scoreBoard = document.getElementById("scoreBoard");
const winText = document.getElementById("winText");

let rows = 5, cols = 6;
let firstCard = null, secondCard = null;
let lockBoard = false;
let score = 0, totalPairs = 15;

function setLevel(r, c, btn) {
    rows = r;
    cols = c;
    totalPairs = (r * c) / 2;

    document.querySelectorAll(".levels button")
        .forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    createBoard();
}

function generateCards() {
    let arr = [];
    for (let i = 1; i <= totalPairs; i++) arr.push(i, i);
    return arr.sort(() => Math.random() - 0.5);
}

function createBoard() {
    board.innerHTML = "";
    score = 0;
    scoreBoard.textContent = "得分：" + score;
    winText.style.display = "none";

    board.style.gridTemplateColumns = `repeat(${cols}, 100px)`;

    generateCards().forEach(value => {
        const card = document.createElement("div");
        card.className = "card";
        card.dataset.value = value;

        card.innerHTML = `
            <div class="card-inner">
                <div class="card-back"></div>
                <div class="card-front">${value}</div>
            </div>
        `;

        card.addEventListener("click", () => flipCard(card));
        board.appendChild(card);
    });
}

function flipCard(card) {
    if (lockBoard || card === firstCard || card.classList.contains("matched")) return;
    card.classList.add("flipped");

    if (!firstCard) {
        firstCard = card;
        return;
    }

    secondCard = card;
    lockBoard = true;
    setTimeout(checkMatch, 600);
}

function checkMatch() {
    if (firstCard.dataset.value === secondCard.dataset.value) {
        firstCard.classList.add("matched");
        secondCard.classList.add("matched");
        score++;
        scoreBoard.textContent = "得分：" + score;
        if (score === totalPairs) winText.style.display = "block";
    } else {
        firstCard.classList.remove("flipped");
        secondCard.classList.remove("flipped");
    }

    firstCard = secondCard = null;
    lockBoard = false;
}

document.getElementById("restartBtn").onclick = createBoard;
createBoard();
</script>

</body>
</html>

